{
	"build": {
		"dockerfile": "Dockerfile",
		"context": "."
	},
	"workspaceFolder": "/workspace",
  	"workspaceMount": "source=${localWorkspaceFolder},target=/workspace,type=bind,consistency=cached",

	// So that host.docker.internal works. Without it, it doesn't.
	"runArgs": [
		"--add-host=host.docker.internal:host-gateway"
	],

	"features": {
		"ghcr.io/devcontainers/features/docker-outside-of-docker:1": {}
	},
	// Set *default* container specific settings.json values on container create.
	"customizations": {
		"vscode": {
			"settings": {
				"lldb.executable": "/usr/bin/lldb",
				// VS Code don't watch files under ./target
				"files.watcherExclude": {
					"**/target/**": true
				},
				// Stop rust analyzer blocking the main build
				"rust-analyzer.check.extraArgs": [
					"--target-dir",
					"/tmp/rust-analyzer-check"
				]
			},
			// Add the IDs of extensions you want installed when the container is created.
			"extensions": [
				"vadimcn.vscode-lldb",
				"mutantdino.resourcemonitor",
				"rust-lang.rust-analyzer",
				"tamasfe.even-better-toml",
				"fill-labs.dependi",
				"glehmann.earthlyls"
			]
		}
	},
	"remoteEnv": {
		// Pass in the host directory for Docker mount commands from inside the container
		"HOST_PROJECT_PATH": "${localWorkspaceFolder}",
		"RUST_LOG": "debug",
		// For tracing_subscriber
		"LOG_LEVEL": "DEBUG",
		"ENABLE_BARRICADE": "1",
		"DATABASE_URL": "postgresql://db-owner:testpassword@host.docker.internal:30001/bionic-gpt?sslmode=disable",
		"APP_DATABASE_URL": "postgresql://bionic_application:testpassword@host.docker.internal:30001/bionic-gpt?sslmode=disable",
		"SIGNOUT_URL": "/auth/sign_out",
		// Use https://10015.io/tools/jwt-encoder-decoder and the option for a sample key
		"DANGER_JWT_OVERRIDE": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyLCJlbWFpbCI6ImpvaG5AYWNtZS5vcmcifQ.daYgeWqnpmtorlFKjb0sdRFDcPPWfow68KRZh3uUDhc",
		// Switch on for row level encryption
		// "CUSTOMER_KEY": "190a5bf4b3cbb6c0991967ab1c48ab30790af876720f1835cbbf3820f4f5d949",
		"INVITE_DOMAIN": "http://envoy:7700",
		"INVITE_FROM_EMAIL_ADDRESS": "support@application.com",
		"SMTP_HOST": "smtp",
		"SMTP_PORT": "1025",
		"SMTP_USERNAME": "thisisnotused",
		"SMTP_PASSWORD": "thisisnotused",
		"SMTP_TLS_OFF": "true"
	}
}
